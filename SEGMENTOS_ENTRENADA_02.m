clear all
clc

% Parametros de la RNA MC
w1 = [-6.75381155255384, -0.0952982503973965, -8.24545738898166, 6.70493093283628, 2.22813586186373, 5.04900895017282, 0.137245474728733, -3.69513205973970, -0.836189249456895, -0.988797935102762, -4.90000512660069, -4.10000000000320];
w2 = [-5.55381155255384, 11.2047017496028, -7.54545738898181, -9.49506906716306, -2.77186413813631, -8.95099104982712, 0.137245474728733, 8.10486794026020, -5.63618924945692, 11.3112020648972, -1.80000512660084, -3.60000000000326];
w3 = [-2.05381155255436, 0.604701749602491, 8.75454261101834, -8.99506906716306, 6.22813586186369, 8.04900895017283, 6.33724547472875, 6.90486794026006, 6.66381075054309, 1.41120206489724, 1.89999487339916, -1.50000000000230];
w4 = [-9.45381155255346, -4.59529825039702, 9.05454261101834, -6.49506906716372, -4.97186413813631, 4.94900895017282, 5.83724547472875, 0.304867940260230, -6.33618924945691, -3.48879793510303, -4.80000512660069, 0.199999999997601];
w5 = [7.74618844744617, 8.80470174960298, 1.35454261101809, 3.20493093283723, 5.12813586186365, -0.850991049827117, 2.83724547472867, 1.80486794026030, -5.73618924945691, 10.9112020648972, 2.09999487339921, -8.30000000000275];
w6 = [8.54618844744654, 1.00470174960251, -8.94545738898166, 4.90493093283628, -5.07186413813631, -1.85099104982714, -2.46275452527133, 1.00486794026022, -6.83618924945691, 12.4112020648972, 4.19999487339931, -4.80000000000320];
w7 = [-0.553811552555386, -1.99529825039692, -5.44545738898181, 3.20493093283723, -1.27186413813634, -1.65099104982715, 6.23724547472875, -6.59513205973994, -5.73618924945691, 1.61120206489722, -5.60000512660069, 6.09999999999680];

w8 = [8.67587991595926, 0.117650696104459, -7.57494798941343, -1.83710242385610];
w9 = [-7.69090645462272, -4.37882309950104, 0.732020437922828, 14.6947232662160];
w10 = [-0.470044515381159, 9.54786242015577, -0.252859267186521, 2.36124600129556];
w11 = [-0.525288875842176, -2.24002509012164, 7.63662001912986, -1.96917788402594];
w12 = [-15.7064651375171, 9.46926700716879, 5.06443512727671, 11.3310657319605];
w13 = [-6.71167902900964, 7.86850738956270, 7.90309634261990, -6.74334283061364];
w14 = [8.91187433947872, 6.24855485662182, 5.50909337804697, -0.0281824112692825];
w15 = [2.66919145021323, -14.7580329072342, -7.59357050330108, -4.17190569407486];
w20 = [-0.162730856380331, -5.35277533944029, 3.62126655105426, -4.18346179705159];
w21 = [-0.0182117831990631, -10.2675015280660, -11.7687507004267, -1.66636266514041];
w22 = [-0.205090048492189, 3.59739590572579, -9.40238847285051, -9.49762522130716];
w23 = [2.49999579063481, -7.30000216400101, 4.89999793760865, -0.199997427175353];

% bias de c/neurona
wb1 = [-1.80265762319862, -4.39667498670600, -4.79028756910676, -0.753257724830783, -2.75609507043000, -4.88846552686887, 0.637193680223231, -4.93713921228011, -4.86538509854234, -13.8523706113764, -7.70843820827177, -9.50000534645434];
wb2 = [3.20336777009465, 4.65129530537546, -2.39013611234455, -8.21936615955634];

% constante para activaci√≥n de la sigmoide
c8 = 10.0;
c9 = 10.0;
c10 = 10.0;
c11 = 10.0;
c12 = 1.0;
c13 = 10.0;
c14 = 10.0;
c15 = 10.0;
c16 = 10.0;
c17 = 10.0;
c18 = 10.0;
c19 = 10.0;
c20 = 10.0;
c21 = 10.0;
c22 = 10.0;
c23 = 10.0;

% para desarrollar los calculos se tienen que generar
% variables intermedias asi como las generales de E/S

x1 = [1.0, 1.0, 1.0, 0.0];
x2 = [1.0, 1.0, 1.0, 0.0];
x3 = [1.0, 1.0, 0.0, 0.0];
x4 = [1.0, 0.0, 1.0, 0.0];
x5 = [0.0, 1.0, 1.0, 1.0];
x6 = [0.0, 1.0, 0.0, 1.0];
x7 = [1.0, 1.0, 1.0, 0.0];

y8 = zeros(1, 7);
y9 = zeros(1, 7);
y10 = zeros(1, 7);
y11 = zeros(1, 7);
y12 = zeros(1, 7);
y13 = zeros(1, 7);
y14 = zeros(1, 7);
y15 = zeros(1, 7);
y16 = zeros(1, 7);
y17 = zeros(1, 7);
y18 = zeros(1, 7);
y19 = zeros(1, 7);
y20 = zeros(1, 7);
y21 = zeros(1, 7);
y22 = zeros(1, 7);
y23 = zeros(1, 7);

%Resultados deseados
p1 = [0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0];
p2 = [1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0];
p3 = [1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0];
p4 = [1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0];

disp("BCD 7 SEGMENTOS ENTRENADO");

% Generamos un ciclo para evaluar los 4 casos de las entradas x1 y x2
disp("1ra fase, calculos iniciales");

for i = 1 : 4
    %se procesa la capa intermedia
    y8(i) = perceptron7(x1(i), w1(1), x2(i), w2(1), x3(i), w3(1), x4(i), w4(1), x5(i), w5(1), x6(i), w6(1), x7(i), w7(1), 1, wb1(1), c8);
    y9(i) = perceptron7(x1(i), w1(2), x2(i), w2(2), x3(i), w3(2), x4(i), w4(2), x5(i), w5(2), x6(i), w6(2), x7(i), w7(2), 1, wb1(2), c9);
    y10(i) = perceptron7(x1(i), w1(3), x2(i), w2(3), x3(i), w3(3), x4(i), w4(3), x5(i), w5(3), x6(i), w6(3), x7(i), w7(3), 1, wb1(3), c10);
    y11(i) = perceptron7(x1(i), w1(4), x2(i), w2(4), x3(i), w3(4), x4(i), w4(4), x5(i), w5(4), x6(i), w6(4), x7(i), w7(4), 1, wb1(4), c11);
    y12(i) = perceptron7(x1(i), w1(5), x2(i), w2(5), x3(i), w3(5), x4(i), w4(5), x5(i), w5(5), x6(i), w6(5), x7(i), w7(5), 1, wb1(5), c12);
    y13(i) = perceptron7(x1(i), w1(6), x2(i), w2(6), x3(i), w3(6), x4(i), w4(6), x5(i), w5(6), x6(i), w6(6), x7(i), w7(6), 1, wb1(6), c13);
    y14(i) = perceptron7(x1(i), w1(7), x2(i), w2(7), x3(i), w3(7), x4(i), w4(7), x5(i), w5(7), x6(i), w6(7), x7(i), w7(7), 1, wb1(7), c14);
    y15(i) = perceptron7(x1(i), w1(8), x2(i), w2(8), x3(i), w3(8), x4(i), w4(8), x5(i), w5(8), x6(i), w6(8), x7(i), w7(8), 1, wb1(8), c15);
    y20(i) = perceptron7(x1(i), w1(9), x2(i), w2(9), x3(i), w3(9), x4(i), w4(9), x5(i), w5(9), x6(i), w6(9), x7(i), w7(9), 1, wb1(9), c20);
    y21(i) = perceptron7(x1(i), w1(10), x2(i), w2(10), x3(i), w3(10), x4(i), w4(10), x5(i), w5(10), x6(i), w6(10), x7(i), w7(10), 1, wb1(10), c21);
    y22(i) = perceptron7(x1(i), w1(11), x2(i), w2(11), x3(i), w3(11), x4(i), w4(11), x5(i), w5(11), x6(i), w6(11), x7(i), w7(11), 1, wb1(11), c22);
    y23(i) = perceptron7(x1(i), w1(12), x2(i), w2(12), x3(i), w3(12), x4(i), w4(12), x5(i), w5(12), x6(i), w6(12), x7(i), w7(12), 1, wb1(12), c23);

    %se procesa la capa de salida
    y16(i) = perceptron8(y8(i), w8(1), y9(i), w9(1), y10(i), w10(1), y11(i), w11(1), y12(i), w12(1), y13(i), w13(1), y14(i), w14(1), y15(i), w15(1), y20(i), w20(1), y21(i), w21(1), y22(i), w22(1), y23(i), w23(1), 1, wb2(1), c16);
    y17(i) = perceptron8(y8(i), w8(2), y9(i), w9(2), y10(i), w10(2), y11(i), w11(2), y12(i), w12(2), y13(i), w13(2), y14(i), w14(2), y15(i), w15(2), y20(i), w20(2), y21(i), w21(2), y22(i), w22(2), y23(i), w23(2), 1, wb2(2), c17);
    y18(i) = perceptron8(y8(i), w8(3), y9(i), w9(3), y10(i), w10(3), y11(i), w11(3), y12(i), w12(3), y13(i), w13(3), y14(i), w14(3), y15(i), w15(3), y20(i), w20(3), y21(i), w21(3), y22(i), w22(3), y23(i), w23(3), 1, wb2(3), c18);
    y19(i) = perceptron8(y8(i), w8(4), y9(i), w9(4), y10(i), w10(4), y11(i), w11(4), y12(i), w12(4), y13(i), w13(4), y14(i), w14(4), y15(i), w15(4), y20(i), w20(4), y21(i), w21(4), y22(i), w22(4), y23(i), w23(4), 1, wb2(4), c19);
end


disp(" ");
disp(" Con valores entrenados");
disp("|| X1 | X2 || X3 || X4 || X5 || X6 || X7 || Yd1 || Yd2 || Yd3 || Yd4 ||  Y1  || Y2 ||  Y3 || Y4 ||");

for i = 1 : 4
    msg = "||" + compose("%.2f", x1(i)) + "|" + compose("%.2f", x2(i)) + "||" + compose("%.2f", x3(i)) + "||" + compose("%.2f", x4(i)) + "||" ...
        + compose("%.2f", x5(i)) + "||" + compose("%.2f", x6(i)) + "||" + compose("%.2f", x7(i)) + "||"  + compose("%.2f", p1(i)) + "||" ...
        + compose("%.2f", p2(i)) + "||" + compose("%.2f", p3(i)) + "||" + compose("%.2f", p4(i)) + "||" + compose("%.4f", y16(i)) + "||" ...
        + compose("%.4f", y17(i)) + "||" + compose("%.4f", y18(i)) + "||" + compose("%.4f", y19(i)) + "||";
    disp(msg);
end